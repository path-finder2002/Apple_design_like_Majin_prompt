<!DOCTYPE html>
<!--
  Google Slide Generator Web Application
  
  JSONデータからGoogleスライドを自動生成するWebアプリケーション
  
  @author まじん
  @version 3.4.0
  @license CC BY-NC 4.0
  @see https://creativecommons.org/licenses/by-nc/4.0/
-->
<html>
<head>
  <?!= include('ui/head'); ?>
</head>
<body>
  <?!= include('ui/header'); ?>
  <main class="container">
    <section class="hero">
      <h1>⚡️<span class="g-letter g-blue">G</span><span class="g-word">oogle</span> <span class="g-letter g-red">M</span><span class="g-word">ajin</span> <span class="g-letter g-yellow">S</span><span class="g-word">lide</span> <span class="g-letter g-green">G</span><span class="g-word">enerator</span>⚡️</h1>
      <p class="hero-subtitle">Material Design ガイドラインに沿った直感的なスライド生成ツール</p>
      <hr class="title-separator">
    </section>
    <div class="main-grid">
      <div class="card">
        <h2>1. スライドデータを入力</h2>
        <div class="card-content">
          <div id="jsonValidation" class="json-validation">
            <div class="validation-status" id="validationStatus">
              <span class="validation-icon material-icons">hourglass_empty</span>
              <span class="validation-text">JSON形式をチェック中...</span>
            </div>
            <div class="validation-details" id="validationDetails"></div>
          </div>
          <textarea id="slideDataInput" placeholder="ここにJSONデータを貼り付けます"></textarea>
          <div style="margin-top:12px; display:flex; justify-content:flex-end;">
            <button id="resetJsonBtn" type="button" class="btn btn-secondary" style="width:auto; padding:10px 16px;">リセット</button>
          </div>
        </div>
      </div>
      <div class="card">
        <h2>2. デザイン設定</h2>
        <div class="card-content">
          <div class="preset-management">
            <div class="preset-controls">
              <label for="presetSelect">保存済みプリセット</label>
              <div class="preset-control-row">
                <select id="presetSelect" class="preset-select">
                  <option value="">プリセットを選択...</option>
                </select>
                <button id="savePreset" type="button" class="btn btn-preset">保存</button>
              </div>
            </div>
          </div>
          
          <div class="settings-grid">
            <div>
              <label for="primaryColor">プライマリカラー</label>
              <div class="color-picker-wrapper">
                <input type="color" id="primaryColor" value="#4285F4">
                <input type="text" id="primaryColorText" value="#4285F4">
              </div>
            </div>
             <div>
              <label for="fontFamily">フォント</label>
              <select id="fontFamily">
                <option value="Product Sans" selected>Product Sans</option>
                <option value="Roboto">Roboto</option>
                <option value="Noto Sans JP">Noto Sans JP</option>
                <option value="Arial">Arial</option>
                <option value="M PLUS 1p">M PLUS 1p</option>
                <option value="Noto Serif JP">Noto Serif JP</option>
              </select>
            </div>
            <div style="grid-column: 1 / -1;">
              <label for="footerText">フッターテキスト</label>
              <input type="text" id="footerText" value="">
            </div>
            <div style="grid-column: 1 / -1;">
              <label for="driveFolderUrl">保存先フォルダURL</label>
              <div class="url-input-wrapper">
                <input type="text" id="driveFolderUrl" value="">
                <button id="openFolderBtn" type="button" class="btn-secondary">開く</button>
              </div>
            </div>
          </div>
          
          <div class="collapsible-section">
            <div class="collapsible-header">
              <span>装飾設定</span>
              <span class="collapsible-icon material-icons">expand_more</span>
            </div>
            <div class="collapsible-content">
              <div class="settings-grid" style="border-bottom: 1px solid var(--border-color); padding-bottom: 16px; margin-bottom: 16px;">
                <div>
                  <label for="hrWidth">区切り線の幅 (px or %)</label>
                  <input type="text" id="hrWidth" value="80px">
                </div>
                <div>
                  <label for="hrHeight">区切り線の太さ (px)</label>
                  <input type="text" id="hrHeight" value="4px">
                </div>
                <div>
                  <label for="hrMarginTop">タイトルとの距離 (px)</label>
                  <input type="text" id="hrMarginTop" value="16px">
                </div>
                <div>
                  <label for="hrColor">区切り線の色</label>
                  <div class="color-picker-wrapper">
                    <input type="color" id="hrColor" value="#4285F4">
                    <input type="text" id="hrColorText" value="#4285F4">
                  </div>
                </div>
              </div>
               <div class="checkbox-wrapper">
                <input type="checkbox" id="showTitleUnderline" checked>
                <label for="showTitleUnderline">タイトル下にアンダーラインを表示</label>
              </div>
              <div class="checkbox-wrapper">
                <input type="checkbox" id="showBottomBar" checked>
                <label for="showBottomBar">スライド下部にフッターバーを表示</label>
              </div>
              <div class="checkbox-wrapper">
                <input type="checkbox" id="showDateColumn" checked>
                <label for="showDateColumn">タイトルスライドに日付を表示</label>
              </div>
              <div class="checkbox-wrapper" style="border-top: 1px solid var(--border-color); margin-top: 12px; padding-top: 12px;">
                <input type="checkbox" id="enableGradient">
                <label for="enableGradient">グラデーションを適用</label>
              </div>
              <div id="gradient-options">
                <div class="settings-grid">
                   <div>
                    <label for="gradientStart">開始色</label>
                    <div class="color-picker-wrapper">
                      <input type="color" id="gradientStart" value="#4285F4">
                      <input type="text" id="gradientStartText" value="#4285F4">
                    </div>
                  </div>
                  <div>
                    <label for="gradientEnd">終了色</label>
                    <div class="color-picker-wrapper">
                      <input type="color" id="gradientEnd" value="#34A853">
                      <input type="text" id="gradientEndText" value="#34A853">
                    </div>
                  </div>
                </div>
                <div class="gradient-preview-section">
                  <label>グラデーションプレビュー</label>
                  <div id="gradientPreview" class="gradient-preview-box"></div>
                </div>
              </div>
            </div>
          </div>

          <div class="collapsible-section">
            <div class="collapsible-header">
              <span>ロゴ・背景設定</span>
              <span class="collapsible-icon material-icons">expand_more</span>
            </div>
            <div class="collapsible-content">
              <div class="note-info">
                画像URLまたはGoogleドライブの共有リンク(File ID)を入力してください。
              </div>
              <div class="settings-grid" style="grid-template-columns: 1fr;">
                <div>
                  <label for="headerLogoUrl">ヘッダーロゴ</label>
                  <div class="url-input-wrapper">
                    <input type="text" id="headerLogoUrl" value="">
                    <button type="button" class="btn-secondary">プレビュー</button>
                  </div>
                </div>
                <div>
                  <label for="closingLogoUrl">クロージングロゴ</label>
                  <div class="url-input-wrapper">
                    <input type="text" id="closingLogoUrl" value="">
                    <button type="button" class="btn-secondary">プレビュー</button>
                  </div>
                </div>
                 <div>
                  <label for="titleBgUrl">タイトル背景</label>
                  <div class="url-input-wrapper">
                    <input type="text" id="titleBgUrl" value="">
                    <button type="button" class="btn-secondary">プレビュー</button>
                  </div>
                </div>
                <div>
                  <label for="sectionBgUrl">セクション背景</label>
                  <div class="url-input-wrapper">
                    <input type="text" id="sectionBgUrl" value="">
                    <button type="button" class="btn-secondary">プレビュー</button>
                  </div>
                </div>
                <div>
                  <label for="mainBgUrl">メイン背景</label>
                  <div class="url-input-wrapper">
                    <input type="text" id="mainBgUrl" value="">
                    <button type="button" class="btn-secondary">プレビュー</button>
                  </div>
                </div>
                <div>
                  <label for="closingBgUrl">クロージング背景</label>
                  <div class="url-input-wrapper">
                    <input type="text" id="closingBgUrl" value="">
                    <button type="button" class="btn-secondary">プレビュー</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="button-group" id="buttonGroup">
            <button id="generateBtn" type="button" class="btn">プレゼンテーションを生成</button>
            <button id="refreshSlidesBtn" type="button" class="btn" style="background: var(--md-sys-color-secondary);">既存スライドのテーマを更新</button>
          </div>
          <div id="status"></div>

        </div>
      </div>
    </div>
  </main>

  <?!= include('ui/footer'); ?>
  <?!= include('common_parser'); ?>
  <script><?!= include('ui/scripts/main'); ?></script>
</body>
</html>
